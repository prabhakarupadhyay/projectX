<!DOCTYPE html>
<html>

<head>
       <!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-114307696-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->
    <link rel="shortcut icon" type="image/png" href="images/favicon.png">
    <title>Mods Fusion</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Stylesheets -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="./assets/css/accslider.css">
    <link rel="stylesheet" type="text/css" href="./assets/css/dynamicPage.css">
        <link rel="stylesheet" type="text/css" href="./assets/css/notif.css">
    <link rel="stylesheet" type="text/css" href="./assets/css/userPanel.css">
    <link rel="stylesheet" type="text/css" href="./assets/css/navbar+footer.css">
    <link rel = "stylesheet" type = "text/css" href = "./assets/dist/css/lightbox.min.css">
    <!--Fonts-->
    <link rel="stylesheet" type="text/css" href="./assets/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Rajdhani|Lato" rel="stylesheet">

</head>

<body>
    
        <div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = 'https://connect.facebook.net/en_US/sdk.js#xfbml=1&autoLogAppEvents=1&version=v2.12&appId=1945744309045122';
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    
    
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=yes">
    <!-- Top NavBar -->
    <nav class="navbar navbar-toggleable-md">
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button>
        <div class="container">
            <div class="col-4">
                <a class="navbar-brand" href="http://modsfusion.com"><img src="./assets/images/modsfuseLogo.png"></a>
            </div>
            <div class="col-4"> </div>
            <div class="col-4 nav-right text-right" id="UserView">
                <a href="/auth/google"><img height="50px" src="./assets/images/gsignin.png"></a>
            </div>
        </div>
    </nav>
    <div id="dynamicAlloc1" class="container main-content">
        <div id="carouselShop" class="carousel slide shop-carousel" data-ride="carousel">
            <div id="dynamicAlloc2" class="carousel-inner image-set" role="listbox" style="height: 400px; width:100%">
                <a id="dynamicBanner" class="carousel-item active" href="" data-lightbox="image-set" style="height: inherit; width: inherit"><img id="Images" class="d-block img-fluid shop-img " src=""></a>
            </div>
            <a class="carousel-control-prev" href="#carouselShop" role="button" data-slide="prev"> <span class="carousel-control-prev-icon" aria-hidden="true"></span> <span class="sr-only">Previous</span> </a>
            <a class="carousel-control-next" href="#carouselShop" role="button" data-slide="next"> <span class="carousel-control-next-icon" aria-hidden="true"></span> <span class="sr-only">Next</span> </a>
        </div>
        <div>
            <h1 id="Name" style="font-family: ariel;">Crave Design</h1>
            <div class="container-fluid" style="width: 100%; font-family: Rajdhani">
                <div class="row" style="width: 100%">
                    <div class="col-md-4">
                        <strong><i class="fa fa-home" aria-hidden="true"></i> Address: </strong><p id="Address" class="address">Opp Pillar No.190, Near Arjunghar Metro Station, Mehrauli Gurgaon Road, New Delhi, Delhi 110047</p>
                    </div>
                    <div class="col-md-4">
                        <strong><i class="fa fa-envelope" aria-hidden="true"></i> Email: </strong><p id="Email" class="email">piyush_peace@hotmail.com</p>
                        <strong><i class="fa fa-globe" aria-hidden="true"></i> Website: </strong><a class="website" id="Website" href="">click here</a>
                    </div>
                    <div class="col-md-4">
                        <strong><i class="fa fa-phone" aria-hidden="true"></i> Contact: </strong><p class="contact" id="Numbers">098919 19081</p>
                    </div>
                </div>
            </div>
            <div class="container-fluid" style="width: 100%; font-family: Rajdhani; text-align: center">
                <strong>Description: </strong><p id="description">
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum sed facilisis lacus. Integer vitae ligula dignissim, aliquam mi eget, aliquet massa. Etiam vel quam non turpis faucibus convallis et id lectus. Ut elementum, magna at consequat tincidunt, est massa volutpat leo, vel pharetra dolor lacus id odio. Aliquam lobortis odio ut libero maximus dignissim. Pellentesque euismod nibh sit amet quam ullamcorper laoreet. </p>
            </div>
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-7">
                        <h2 style="font-family: ariel;">Cars Available: </h2>
                        <ul id="dynamicAlloc3" class="dock">
                            <li id="dynamicCars"></li>
                        </ul>
                        
<!--                        <iframe id="api-frame" src="" allowvr allowfullscreen mozallowfullscreen="true" webkitallowfullscreen="true" onmousewheel=""></iframe>-->
                        
                        <div width = "100%" height = "500px" border = "2"><img  id="api-frame" src="audi.png" alt="Smiley face" height="400px" width="100%"></div>
                    </div>
                    <div class="col-md-5">
                        <h2 style="font-family: ariel; text-align: right">Parts Available: </h2>
                        <div id="parts-container">
                            <ul class="faq" id="dynamicAlloc4">
                                <ul class="dynamicParts">
                                <li class="category" id="partType"></li>
                                <li class="sub-category">
                                    <ul class="faq" id="subDynamicParts">
                                        <div>
                                            <li class="category model" id="partName"></li>
                                            <li class="sub-category model-holder" id="partUrl"><a href="./assets/images/dynamicPage/spoiler1.jpg" data-lightbox="spoiler-set"><img src = "./assets/images/dynamicPage/spoiler1.jpg"></a></li>
                                        </div> 

                                    </ul>
                                </li>
                                </ul>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class = "container-fluid" style="text-align: center; padding-top: 20px; padding-bottom: 30px;">
                <form>
                   <div>
                       <input type="radio" name="bookOption" value="whatsApp" checked> WhatsApp Msg
                       <input type="radio" name="bookOption" value="call" style="margin-left:10px"> Call
                   </div>  
                   <button type="button" id="bookCallBtn" class="btn" style="font-family: georgia;margin-top:10px">Book a Call/WhatsappMsg</button>
                   <p id="bookMessage" style="color:red; font-size:15px;margin-top:7px"></p>
                </form>
            </div>
            
                       
            <div class="container-fluid" style="font-family: Rajdhani; text-align: left">
                <div class="row">
                    <div class="col-md-6">
                        <div id="oval1"><strong>WhatsApp Msg:</strong><p>You can whatsapp us directly or book a whatsapp message above. We will message you asking your car modification requirements and  buddget regarding this shop and will bring back the best response from this shop including all the costs along with the visuals of the product if available in the shop.</p></div>
                        <br>
                    </div>
                    <div class="col-md-6">
                        <div id="oval1"><strong>Call:</strong><p>You can call us directly or book a call above. We will contact you asking your car modification requirements and  buddget regarding this shop and will bring back the best response from this shop including all the product costs and installation charges.</p></div>
                    </div>                    
                </div>
            </div>
        </div>
        
        <!-- USER PANEL -->
    <div class="modal fade" id="UserPanel" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content user">
                <div class="modal-header user-head">
                    <div style="text-align: center; width: 100%">
                        <h5 class="m-title">USER PANEL</h5></div>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="fa fa-times" aria-hidden="true"></i></button>
                </div>
                <div class="modal-body user-body">
                    <form class="container-fluid userform" id="formPanel">
                        <div class="form-group row">
                            <label for="name" class="col-2 userlabel">Name: *</label>
                            <div class="col-10">
                                <input type="text" class="form-control userinput" id="Name" placeholder="" name="impField_Name" maxlength="90"> </div>
                        </div>
                        <div class="form-group row">
                            <label for="state" class="col-2 userlabel">State: </label>
                            <div class="col-2">
                                <input type="text" class="form-control userinput" id="State" placeholder="" maxlength="50"> </div>
                            <label for="city" class="col-2 userlabel">City: </label>
                            <div class="col-2">
                                <input type="text" class="form-control userinput" id="City" placeholder="" maxlength="100"> </div>
                            <label for="state" class="col-2 userlabel">Zip-Code: </label>
                            <div class="col-2">
                                <input type="number" class="form-control userinput" id="Zipcode" placeholder="" maxlength="20"> </div>
                        </div>
                        <div class="form-group row">
                            <label for="address" class="col-2 userlabel">Address: </label>
                            <div class="col-10">
                                <textarea class="form-control userinput" id="Address" rows="2" maxlength="240"></textarea>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="number" class="col-2 userlabel">Number: *</label>
                            <div class="col-10">
                                <input type="number" class="form-control userinput" id="Number" name="impField_Number" maxlength="13"> </div>
                        </div>
                        <div style="text-align: center">
                            <button type="submit" class="btn" id="submitPanel">Save Changes</button>
                        </div>
                        <p style="font-size : 11px;">* fields are imp for booking a call/whatsAppMsg</p>
                    </form>
                </div>
            </div>
        </div>
    </div>
        <!--USER PANEL ENDS-->
        <!-- NOTIFICATION -->
        <div class="modal fade" id="Notification" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content notif">
                    <div class="modal-header notif-head">
                        <h5 class="m-title">NOTIFICATIONS</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">&times;</span> </button>
                    </div>
                    <div class="modal-body notif-body">
                        <div class="container noty-holder">
                            <div class="alert alert-read alert-dismissible fade show" role="alert">
                                <button type="button" class="close" data-dismiss="alert" aria-label="Close"> <span aria-hidden="true">&times;</span> </button> <strong>Holy guacamole!</strong> No Notification </div>
                        </div>
                    </div>
                    <div class="modal-footer notif-foot">
                        <button type="button" class="btn" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-md-4 col-sm-6 footerleft ">
                    <div class="logofooter"><img src="./assets/images/modsfuseLogo.png" style="height: 65px; width: 200px;"></div>
                    <p>Contact Us via Call/WhatsApp for any modification demands or queries - </p>
                    <p><i class="fa fa-phone"></i> <span>Phone/whatsapp : </span><span id="companyNumber">not available</span></p>
                    <p><i class="fa fa-envelope"></i> E-mail : 1developer.mail@gmail.com</p>
                </div>
                <div class="col-md-2 col-sm-6 paddingtop-bottom">
                    <h6 class="heading7">TWITTER FEED</h6>
                    <ul class="footer-ul">
                        <li><a class="twitter-timeline" data-height="200" data-theme="light" href="https://twitter.com/mods_fusion?ref_src=twsrc%5Etfw">Tweets by mods_fusion</a> </li>
                    </ul>
                </div>
                <div class="col-md-3 col-sm-6 paddingtop-bottom">
                    <h6 class="heading7">LATEST FB POST</h6>
                    <div class="post">
                        <div class="fb-page" data-href="https://www.facebook.com/modsfusion/" data-tabs="timeline" data-height="200" data-small-header="true" data-adapt-container-width="true" data-hide-cover="false" data-show-facepile="true"><blockquote cite="https://www.facebook.com/modsfusion/" class="fb-xfbml-parse-ignore"><a href="https://www.facebook.com/modsfusion/">Mods Fusion</a></blockquote></div>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6 paddingtop-bottom">
                    <h6 class="heading7">SOCIAL MEDIA</h6>
                    <blockquote class="blockquote">
                        <blockquote cite="https://www.facebook.com/modsfusion"><a href="https://www.facebook.com/modsfusion/" style="color:#57aee3">Facebook</a></blockquote>
                        <blockquote cite="https://twitter.com/mods_fusion"><a href="https://twitter.com/mods_fusion" style="color:#57aee3">Twitter</a></blockquote>
                        <p style="font-size:16px"><a href="https://www.facebook.com/onedeveloper.1" style="color:#c71ce0;">Follow the journey of an entrepreneur</a></p>
                    </blockquote>
                </div>
            </div>
        </div>
    </footer>
    <!--Footer2-->
    <div class="copyright">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <p>Â© 2017-2018 Mods Fusion</p>
                </div>
                <div class="col-md-6">
                    <ul class="bottom_ul">
                        <li><a href="/privacy">privacy</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!-- NOTIFICATION ENDS-->
    <!-- bottom nav -->
    <div class="navbottom-content container"> </div>
    <nav class="navbar navbar-toggleable-md fixed-bottom container navbottom">
        <div class="col-4"> 
            <a id="userTray" data-toggle="modal" data-target="#UserPanel" style="visibility:hidden;"><i class="fa fa-user" aria-hidden="true"></i></a>
        <a data-toggle="modal" data-target="#Notification"><i class="fa fa-bell" aria-hidden="true"></i></a>
        </div>
        <div class="col-4">
            <ul class="nav nav-pills nav-stacked col-md-1">
                <li class="nav-item active"> <a class="nav-link" href="http://modsfusion.com/">HOME</a> </li>
                <li class="nav-item"> <a class="nav-link" href="#" id="dynShops">SHOPS</a> </li>
                <li class="nav-item"> <a class="nav-link" href="/locationSearch">SEARCH</a> </li>
                <li class="nav-item"> <a class="nav-link" href="/about">ABOUT</a> </li>
            </ul>
        </div>
    </nav>
    <!-- bottom nav -->
    <!-- Scripts -->
    <script src="https://www.gstatic.com/firebasejs/4.2.0/firebase.js"></script>
    <!--firebase-->
    <script type="text/javascript" src="./assets/js/jquery-3.1.1.min.js"></script>
    <!--jquery-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
    <!--tether-->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
    <!--bootstrap-->
    <script type="text/javascript" src="./assets/js/dynamicPage.js"></script>
    <script src="./assets/js/notif.js"></script>
    <script src="./assets/js/accslider.js" id="partsSlider"></script>
    <script src = "./assets/dist/js/lightbox-plus-jquery.min.js"></script>
    <script id="modifiable">
        
        
        
        //Shop Allocation
        var dynamicAlloc1 = document.getElementById('dynamicAlloc1');
        var dynamicAlloc2 = document.getElementById('dynamicAlloc2');
        var dynamicBanner = document.getElementById('dynamicBanner');
        var dynamicAlloc3 = document.getElementById('dynamicAlloc3');
        var dynamicCars   = document.getElementById('dynamicCars');
        var dynamicAlloc4 = document.getElementById('dynamicAlloc4');
        
        var partsSlider = document.getElementById('partsSlider');
        
        var apiframe    = document.getElementById('api-frame');
        var userTray    = document.getElementById('userTray');
        var submitPanel = document.getElementById('submitPanel');
        var formPanel   = document.getElementById('formPanel');   
        
        
        var bookCallBtn = document.getElementById('bookCallBtn');   
        var bookOption  = document.getElementsByName('bookOption');   
        var userNam     = document.getElementsByName('impField_Name');   
        var userNum     = document.getElementsByName('impField_Number');   
        var bookMessage = document.getElementById('bookMessage');   
        var dynShops = document.getElementById('dynShops');   
        
        
        var firstCallCarsFlag = true;
        var userLoggedIn = false;
        
        
        
        feedShopsTag();
        
        dynamicAlloc3.onclick = function(e){
            
            if(e.target.tagName == 'LI' && e.target.id == 'dynamicCars'){
                            
                unbindClickListener();
                var carNamez = e.target.innerHTML;
                CurCarAndParts(carNamez,e.target.className); 
                bindClickListener();
            } 
        }
        
        
        bookCallBtn.onclick = function(){
            bookMessage.innerHTML = '';
            if(userLoggedIn){
            }else{
                bookMessage.innerHTML = "Please login to enable booking";  
            }
        }
        
        
        userTray.onclick = function(){loadUserData();}
        
        //check if common variable is present or not
        if (typeof Ser_comLoadDat != 'undefined') {
            if(Ser_comLoadDat != 'Nothing to show........Please add some shops'){
                executeComUserFunc();
            }
        }
        
        function executeComUserFunc() {
            var countObj = Ser_comLoadDat.length;
            for (let i in Ser_comLoadDat) {
                
                if(Array.isArray(Ser_comLoadDat[i])){
                    var currentObj = Ser_comLoadDat[i];
                    if(typeof currentObj[0] === 'object'){
                        for(let k in currentObj){
                        sortFeedCars(currentObj[k],k);
                        }
                    }else{
                        if(currentObj[0]!= "null"){
                            bookingResponse(currentObj);
                        }
                    }
                    
                }else{
                    
                    var currentObj = Ser_comLoadDat[i];
                    var objectKeys = Object.keys(currentObj);
                    for (let j in objectKeys) {
                        var currentKey = objectKeys[j];
                        var currentTag = dynamicAlloc1.querySelector('#' + currentKey);
                        if(currentKey == 'Images'){
                            sortFeedBanner(currentTag,currentObj[currentKey]);
                        }else{
                            
                            feedTags(currentTag, currentObj[currentKey], function (newCurrentTag) {
                                console.log(newCurrentTag);
                            });                            
                        }
                    }
                }
            }
        }
        
        
        function unbindClickListener(){
            $(document).ready(function(){
                $('li.category').unbind( "click" );
            });
        }
        
        
        function bindClickListener(){
            var action="click";
            var speed="500";

            $(document).ready(function(){
	$('li.category').click(function(){
		$(this).next()
			.slideToggle(speed)
				.siblings('li.sub-category')
					.slideUp();
		var img = $(this).children('img');
		//Remove the 'rotate' class except the active 
		$('img').not(img).removeClass('rotate');
		//Toggle rotate class
		img.toggleClass('rotate');
	});
});
            
        }
        
        
        
        
        function feedShopsTag(){
            var myHref = window.location.href.split('?');
            if(myHref.length == 1){
                
            }else{
                var myHrefLast = myHref[myHref.length-1];
                var myHrefSplit =  myHrefLast.split('/').shift();
                dynShops.setAttribute('href','/searchShops?'+myHrefSplit);
            }
        }
        
        
        
        function bookingResponse(currentObj){
        
            bookCallBtn.disabled = true;
            bookMessage.style.color = 'green';
            if(currentObj == "whatsApp"){
                bookMessage.innerHTML = "We will contact you soon for this shop via "+currentObj[0]+" message.";}
            else{
                bookMessage.innerHTML = "We will contact you soon for this shop via "+currentObj[0];
            }
            
        }
        
        
        
        
        function sortFeedCars(currentObj,currCount){
            
            let breakKeys = Object.keys(currentObj);  
            feedTags(dynamicCars,breakKeys[0], function(res){});
            dynamicCars.setAttribute('class',JSON.stringify(currentObj[breakKeys[0]]));
            
            if (currCount == 0) {
                dynamicCars = dynamicCars.cloneNode(true); 
                CurCarAndParts(breakKeys[0],JSON.stringify(currentObj[breakKeys[0]]));
                firstCallCarsFlag = false;
            }
            else {
                dynamicAlloc3.appendChild(dynamicCars);
                dynamicCars = dynamicCars.cloneNode(true);
            }              
        }
        
        
        
        
        function CurCarAndParts(carName,partsStr){
            
            var dynamicPartsArr = dynamicAlloc4.getElementsByClassName("dynamicParts");
            var countPartsObj=0;
            var partsObj = JSON.parse(partsStr);
            var usableObj = {};
            //console.log(partsObj);
           
           
            for(var i in partsObj){
                countPartsObj++;
                if(i == carName){}else{
                    
                    if(i == 'MAIN'){
                        var mainObjKeys = Object.keys(partsObj[i]);
                        feedTags(apiframe,partsObj[i][mainObjKeys[0]], function(res){});
                    }else{
                        usableObj[i] = partsObj[i];
                    }
                }
                
                if(countPartsObj == Object.keys(partsObj).length){
                    sortPartsElements(dynamicAlloc4,usableObj);
                }
            }
            
            var usableObjKeys = Object.keys(usableObj);
            for(let j in usableObjKeys){
                var currentTag = dynamicPartsArr[j];    
                sortForParts(currentTag,usableObj[usableObjKeys[j]],usableObjKeys[j]);
            } 
        }


        
        function sortForParts(currentTag,partsObj,partName){
            
            var currentSubType = currentTag.querySelector('#partType');
            feedTags(currentSubType,partName, function(res){});
            var subDynamicParts = currentTag.querySelector('#subDynamicParts');
            var jCount = 0;
            sortPartsElements(subDynamicParts,partsObj);
            var subDynamicPartsChild = subDynamicParts.children;    
            
            for(var j in partsObj){
                var currentSubName = subDynamicPartsChild[jCount].querySelector('#partName');
                var splitModelName = j.split('_').pop().split('.').shift();
                var modelName = "Model_"+splitModelName;
                feedTags(currentSubName,modelName, function(res){});
                var currentSubUrl = subDynamicPartsChild[jCount].querySelector('#partUrl');
                var anchorTG = currentSubUrl.firstChild;
                feedTags(anchorTG,partsObj[j], function(res){});
                feedTags(anchorTG.firstChild,partsObj[j], function(res){});
                jCount++;
            }      
        }
        
     
        
        
        function sortPartsElements(subDynamicParts,partsObj){
            
            var objElemCount = Object.keys(partsObj).length;
            var tagElemCount = subDynamicParts.childElementCount;
            if(objElemCount > tagElemCount){
                var diff = objElemCount - tagElemCount;
                var firstTag = subDynamicParts.children[0];
                for(let c=0; c< diff; c++){
                    var cloneSubTag = firstTag.cloneNode(true);
                    subDynamicParts.appendChild(cloneSubTag);
                }
            }else if(objElemCount < tagElemCount){
                var diff = tagElemCount - objElemCount;
                for(let c=0; c< diff; c++){
                    var tagDelete = subDynamicParts.children[c];
                    subDynamicParts.removeChild(tagDelete);
                }
            }
            
        }
        
        
        
        function sortFeedBanner(currentTag,images){
            
            var imgArr = images.split(',');
            
            for(let i in imgArr){
   
                var currentImg = dynamicBanner.querySelector('#Images');   
                feedTags(currentImg,imgArr[i], function(res){});
                feedTags(dynamicBanner,imgArr[i], function(res){});
  
                if (i == 0) {
                    dynamicBanner = dynamicBanner.cloneNode(true); 
                    dynamicBanner.setAttribute('class','carousel-item');
                }
                else {
                    dynamicAlloc2.appendChild(dynamicBanner);
                    dynamicBanner = dynamicBanner.cloneNode(true);
                    dynamicBanner.setAttribute('class','carousel-item');
                    
                }                
            }
        }
        
        

        function feedTags(currentTag, tagValue, callback) {
            if (currentTag.tagName == 'IMG' || currentTag.tagName == 'IFRAME') {
                currentTag.setAttribute('src', tagValue);
                callback(currentTag);
            }else if(currentTag.tagName == 'A'){
                currentTag.setAttribute('href', tagValue);
                callback(currentTag);
            }
            else if (currentTag.tagName == 'DIV' || currentTag.tagName == 'P' || currentTag.tagName == 'H1' || currentTag.tagName == 'LI') {
                currentTag.innerHTML = tagValue;
                callback(currentTag);
            }
            else {
                callback("tag not found.");
            }
        }
        
        
        
        
            //***For Testing*** var Ser_logUserDat = [{"User_Email_Name": "Science Maniac","User_Picture":"./assets/images/user.jpg"}]
        if (typeof Ser_logUserDat != 'undefined') {
            executeLogUserFunc();
            loadUserData();
        }

        function loadUserData() {
            var userview = document.getElementById('UserView');
                
                var username = Ser_logUserDat[0]["User_Email_Name"];
                var userpic = Ser_logUserDat[0]["User_Picture"];
                var shopname = Ser_logUserDat[0]["Shop_User_Email_Name"];
                var shoppic = Ser_logUserDat[0]["Shop_User_Picture"];
                userview.innerHTML = '<img class = "userpic" src = ' + (userpic || shoppic) + '>';
                userview.innerHTML += '<h1 class = "username">' + (username || shopname) +'</h1>';
            
                userTray.style.visibility = "visible";
            
            if(Ser_logUserDat[1] != undefined){
                
                for(var i=0;i < formPanel.elements.length; i++){
            
                    if(formPanel.elements[i].tagName == 'INPUT' || formPanel.elements[i].tagName == 'TEXTAREA'){
                 
                        if(formPanel.elements[i].type != 'button'){
                
                            for(var j in Ser_logUserDat[1]){
                        
                                if(j == formPanel.elements[i].id){
                            
                                    if(j == 'Number' || j == 'Zipcode'){
                                       formPanel.elements[i].value = Ser_logUserDat[1][j]; 
                                    }else{
                                        formPanel.elements[i].value = Ser_logUserDat[1][j];  
                                    }
                                    
                                }  
                            }   
                        }
                    }                
                } 
            }            
            
        }

        
        function executeLogUserFunc() {
            var getLoginKeys = Object.keys(Ser_logUserDat[0]);
            var splitLoginKeys = getLoginKeys[0].split('_')[0];
            //pass this to authorize the firebase on user login(after which it is deleted)      
            var idTokenName = splitLoginKeys + "_IdToken";
            //pass this value with every socket resquest to the server       
            var accessToken = splitLoginKeys + "_AccessToken";
            var callOnce = true;
            var FireBaseUser = null;
            //user creds for firebase 
            var configFirebase = {
                apiKey: "AIzaSyCB3xwPLgUI6O4AQQQYxW8PaZWsAcrXRq0"
                , authDomain: "titanium-flash-171510.firebaseapp.com"
                , databaseURL: "https://titanium-flash-171510.firebaseio.com"
                , projectId: "titanium-flash-171510"
                , storageBucket: "titanium-flash-171510.appspot.com"
                , messagingSenderId: "284593292198"
                , "gcm_sender_id": "103953800507"
            };
            firebase.initializeApp(configFirebase);
            var unsubscribe = firebase.auth().onAuthStateChanged(function (firebaseUser) {
                unsubscribe();
                //check if user is logged in to firebase or not
                if (isUserEqual(firebaseUser) == false || Ser_logUserDat[0][idTokenName] != null) {
                    var credential = firebase.auth.GoogleAuthProvider.credential(Ser_logUserDat[0][idTokenName]);
                    // Sign in with credential from the Google user.
                    firebase.auth().signInWithCredential(credential).then(function (result) {
                        //user successfully logged in to firebase
                        //listen to change in socket events
                        listeToSockets(result);
                    }).catch(function (error) {
                        //prompt user to login again
                    });
                }
                else {
                    //user already signed in
                    listeToSockets(firebaseUser);
                }
            });


            function listeToSockets(firebaseUser) {
                userLoggedIn = true;
                FireBaseUser = firebaseUser.uid;
                //listen to changes at specific socket id
                firebase.database().ref('Channels/Sockets/' + firebaseUser.uid).on('value', function (socketResponse) {
                    //delete id_token in database once the user is logged in
                    if (Ser_logUserDat[0][idTokenName] != null && callOnce == true) {
                        callOnce = false;
                        //call once the user is authorized
                        delIdToken(firebaseUser, accessToken, Ser_logUserDat[0][accessToken], idTokenName);
                    }
                    //get the results/values/response/data of the socket data request
                    console.log(socketResponse.val());
                    //remove the data from the firebase db to free the space once the data is recieved
                    firebase.database().ref('Channels/Sockets/' + firebaseUser.uid).remove();
                });
            }

            
            function delIdToken(firebaseUser, keyName, keyValue, keyNameToDelete) {
                var makeObj = {
                        Event_Name: "deleteTokValue"
                        , Array_info: [keyName, keyValue, keyNameToDelete]
                    }
                    //pass data to server at specific socket id(different for every user) to delete id_token(not to be confused with accessToken)
                firebase.database().ref('Channels/Sockets/' + firebaseUser.uid).set(makeObj);
            }
            

            function isUserEqual(firebaseUser) {
                if (firebaseUser) {
                    var providerData = firebaseUser.providerData;
                    console.log(firebase.auth.GoogleAuthProvider.PROVIDER_ID);
                    for (var i = 0; i < providerData.length; i++) {
                        console.log(providerData[i].providerId);
                        if (providerData[i].providerId === firebase.auth.GoogleAuthProvider.PROVIDER_ID) {
                            return true;
                        }
                    }
                }
                return false;
            }

                    //push access token name and value to the object

                
            var userInfoObj = {
                  Name: ''
                , State: ''
                , City: ''
                , Zipcode: ''
                , Address: ''
                , Number: ''    
            }            
               
            submitPanel.onclick = function(e){
                if(userLoggedIn){
                var submitButton = e.target.parentNode;
                var thisForm = submitButton.parentNode;
                for(var i=0;i < thisForm.elements.length; i++){
            
                    if(thisForm.elements[i].tagName == 'INPUT' || thisForm.elements[i].tagName == 'TEXTAREA'){
                 
                        if(thisForm.elements[i].type != 'button'){
                
                            for(var j in userInfoObj){
                        
                                if(j == thisForm.elements[i].id){
                            
                                    if(j == 'Number' || j == 'Zipcode'){
                                        userInfoObj[j] = thisForm.elements[i].value.toString();
                                    }else{
                                        userInfoObj[j] = thisForm.elements[i].value;   
                                    }
                                    
                                }  
                            }   
                        }
                    }                
                } 
                          
                userInfoObj[accessToken] = Ser_logUserDat[0][accessToken];
                if (splitLoginKeys == 'User') {
                    userInfoObj.Event_Name = "UserData";   
                }
                else {
                    userInfoObj.Event_Name = "ShopOwnerData";   
                }
                firebase.database().ref('Channels/Sockets/' + FireBaseUser).set(userInfoObj);
                submitButton.children[0].innerHTML = "Saved";   
                submitButton.children[0].disabled = true;
                return false;   
           
                }
            }
            
                   
            bookCallBtn.onclick = function(){
                bookMessage.innerHTML = '';
                if(userLoggedIn){
                    if(userNam[0].value != "" && userNum[0].value != ""){
                        bookCallBtn.disabled = true;
                        sendBooking(bookOption,function(ress){
                            console.log(ress);
                            bookMessage.style.color = 'green';
                            bookMessage.innerHTML = ress;
                            
                        });
                    }else{
                        bookMessage.innerHTML = "Name/Number: Missing in User Panel";
                        userTray.style.boxShadow = "2px 2px 15px white";
                    }
                }else{
                    bookMessage.innerHTML = "Please login to enable booking";  
                }
            }
            
            
            function sendBooking(bookOption,callback){
                
                var curPath = window.location.pathname;
                var splitCurPath = curPath.split('/');
                var userBookObj = {
                    Dynamic_Url : splitCurPath[2],
                }
                userBookObj[accessToken] = Ser_logUserDat[0][accessToken];
                for(var l in bookOption){
                    if(bookOption[l].checked){               
                        userBookObj['Book_Option'] = bookOption[l].value;
                    }
                }
                if (splitLoginKeys == 'User') {
                    userBookObj.Event_Name = "UserData";
                    userBookObj.Event_Name2 = "UserDataBook";
                    
                }
                else {
                    userBookObj.Event_Name = "ShopOwnerData";   
                    userBookObj.Event_Name2 = "ShopOwnerDataBook";   
                }
                
                firebase.database().ref('Channels/Sockets/' + FireBaseUser).set(userBookObj);
                callback("Booked.We will contact you soon for your requirements on behalf of this shop");
            }    
        }
        
        
    </script>
</body>

</html>